@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix ardo: <http://www.arida.com/ontology/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .


<PessoaAnonimizada_contratos> a rr:TripleMap;
	rr:logicalTable
		[
			rr:sqlQuery """
				select distinct substring(cpfcontratada,1,11) as cpf_anonimizado, cpfcontratada
				from contratos
				where cpfcontratada is not null and not (cpfcontratada like '%:%')
			"""
		];
	
	rr:subjectMap
		[
			rr:class ardo:Pessoa_Anonimizada;
			rr:template "http://www.arida.com/siasg/resources/Pessoa_Anonimizada/{cpf_anonimizado}"
		];

	rr:predicateObjectMap 

		[
			rr:predicate ardo:cpf_anonimizado;
			rr:objectMap [ rr:column '"cpfcontratada"' ]
		] .

<PessoaAnonimizada_Compras> a rr:TripleMap;
	rr:logicalTable
		[
			rr:sqlQuery """
				SELECT * 
				FROM compras_sem_licitacao_do_ceara_item
				where nu_cpf_vencedor is not null
			"""
		];
	
	rr:subjectMap
		[
			rr:class ardo:Pessoa_Anonimizada;
			rr:template "http://www.arida.com/siasg/resources/Pessoa_Anonimizada/{nu_cpf_vencedor}"
		];

	rr:predicateObjectMap 

		[
			rr:predicate ardo:cpf_anonimizado;
			rr:objectMap [ rr:column '"nu_cpf_vencedor"' ]
		] .